---
description: >-
  TM3Loc: Tightly-Coupled Monocular Map Matching for High Precision Vehicle
  Localization
---

# \[TITS 2022] TM3Loc

## Abstract

Vision-based map-matching with HD map for high precision vehicle localization has gained great attention for its low-cost and ease of deployment. However, its localization performance is still unsatisfactory in accuracy and robustness in numerous real applications due to the sparsity and noise of the perceived HD map landmarks. This article proposes the tightly-coupled monocular map-matching localization algorithm (TM3Loc) for monocular-based vehicle localization. TM3Loc introduces semantic chamfer matching (SCM) to model monocular map-matching problem and combines visual features with SCM in a tightly-coupled manner. By applying the sliding window-based optimization technique, the historical visual features and HD map constraints are also introduced, such that the vehicle poses are estimated with an abundance of visual features and multi-frame HD map landmark features, rather than with single-frame HD map observations in previous works. Experiments are conducted on large scale dataset of 15 km long in total. The results show that TM3Loc is able to achieve high precision localization performance using a low-cost monocular camera, largely exceeding the performance of the previous state-of-the-art methods, thereby promoting the development of autonomous driving.

## Introduction

Existing high-precision localization techniques based on differential RTK (D-RTK), such as GNSS, can theoretically achieve centimeter-level localization precision. However, in real applications such as urban scenarios, a large localization deviation is often seen when the surrounding buildings and trees block the GNSS signal, making using the GNSS sensor alone becomes insufficient \[4,5].

> \[4] A. Kumar, T. Oishi, S. Ono, A. Banno, and K. Ikeuchi, “Global coordinate adjustment of 3D survey models in world geodetic system under unstable GPS condition,” in Proc. 20th ITS World Congr. Tokyo, Jan. 2013, p. 10.&#x20;
>
> \[5] A. Aggarwal, “Machine vision based self-position estimation of mobile robots,” Int. J. Electron. Commun. Eng. Technol., vol. 6, no. 10, pp. 20–29, 2015.

In recent years, since its first inception in late 2010, High-Definition Maps (HD Maps) has gained tremendous popularity in the intelligent vehicle industry, mainly because it carries road elements with a much higher level of details compared to the traditional navigation maps \[6]. Several map building companies have engaged in constructing their HD map databases on a large scale with a series of production and publication standards, such as Navigation Data Standard (NDS) and Local Dynamic Map (LDM). The mainstream approach to building HD Maps is through Mobile Mapping System (MMS) equipped with high precision sensors including LiDAR, RTK and IMU at centimeter-level precision. The resultant map then consists of fine localization features that can support intelligent vehicles’ positioning and trajectory planning. The localization feature in the HD map can be divided into a) dense point cloud feature and b) sparse landmark feature. The point cloud feature consists of the original point cloud scanned by 3D LiDAR sensor \[7], which maintains the raw geometric information of the point cloud. State-of-the-art map-based localization methods use point cloud HD map to accurately estimate vehicle pose within a maximum error of 0.2 m \[8]–\[10]. However, equipping intelligent vehicles (IVs) with LiDAR sensors will significantly and undesirably increase the overall sensor cost and the subsequent vehicle production cost. Furthermore, the huge data size of the point cloud map increases the difficulty in implementing the HD map on IVs. Compared to the landmarks in the point cloud map, the lightweight HD map landmark features are more flexible and easy to use. The HD map landmarks consist of static vectorized semantic landmarks (such as lane lines, poles, and traffic signs), which are much more lightweight than those in the original point cloud map. Matching the HD map landmark features with the images from the low-cost camera is an engineering- and commercial-friendly solution for mass-produced vehicles. As a result, researchers have been investing great efforts in matching these HD map landmarks with features in the camera images. The basic idea behind this approach is to detect semantic landmarks of HD map in the camera image. The vehicle pose can then be obtained by aligning the detected landmarks in the image with their corresponding 3D landmarks in the HD map.

> \[7] K. Yoneda, H. Tehrani, T. Ogawa, N. Hukuyama, and S. Mita, “LiDAR scan feature for localization with highly precise 3-D map,” in Proc. IEEE Intell. Vehicles Symp., Jun. 2014, pp. 1345–1350.&#x20;
>
> \[8] G. Wan et al., “Robust and precise vehicle localization based on multi- sensor fusion in diverse city scenes,” in Proc. IEEE Int. Conf. Robot. Autom. (ICRA), May 2018, pp. 4670–4677.
>
> \[9] X. Zuo, P. Geneva, Y. Yang, W. Ye, Y. Liu, and G. Huang, “Visual- inertial localization with prior LiDAR map constraints,” IEEE Robot. Autom. Lett., vol. 4, no. 4, pp. 3394–3401, Oct. 2019.&#x20;
>
> \[10] W. Ding, S. Hou, H. Gao, G. Wan, and S. Song, “LiDAR inertial odometry aided robust LiDAR localization system in changing city scenes,” in Proc. IEEE Int. Conf. Robot. Autom. (ICRA), May 2020, pp. 4322–4328.

We propose TM3Loc, a novel localization algorithm for improving the performance of the monocular map-matching process. First, to deal with the map-matching problem in the image plane, we adopt the semantic chamfer matching (SCM) algorithm, inspired by the traditional image alignment method, chamfer matching. In TM3Loc, we used SCM as a general cost model to match different landmarks. However, instead of optimizing the cost model using global search or automatic derivatives, we derived an analytical derivation of chamfer matching cost with respect to the 6-DoF pose on se(3) to ensure efficient optimization. Besides, to tackle the inevitable noise of HD map landmark feature detection, an effective outlier rejection strategy is also proposed. With the improved SCM implementation, the monocular map-matching problem can be efficiently and robustly solved in a unified form with various landmark shapes, thereby avoiding the inaccuracy brought by any prior assumption of the target shapes.

Secondly, to deal with the sparsity of HD map landmark features, we introduce the visual features from monocular images in the map-matching process. we introduce a tightly-coupled sliding window-based optimization strategy to fuse the map-matching and visual feature localization con- straints. Similar idea is also utilized in our previous work \[26]. The basic concept is to optimize the poses with the minimiza- tion target consisting of both visual landmark feature residuals and HD map landmark feature residuals in a certain length of past frames. As a result, the localization estimator can provide the global pose of the current frame even when the current HD map observations are insufficient. Moreover, with the aid of the more abundant and accurate constraints of visual feature landmarks, the system can be more robust against the HD map observation noise and offer a more accurate localization result. However, the calculation of SCM for multi-frames in the tightly-coupled sliding window-based optimization is generally time-consuming, making it challenging to meet the real-time performance. As a further improvement of tightly-coupled strategy in \[26], a linearization approximation algorithm that simplifies the SCM residual is also proposed to accelerate the overall optimization process. With this algorithm, the tightly-coupled sliding window-based optimization can be solved in real-time with a negligible performance drop.

> \[26] T. Wen, Z. Xiao, B. Wijaya, K. Jiang, M. Yang, and D. Yang, “High pre- cision vehicle localization based on tightly-coupled visual odometry and vector HD map,” in Proc. IEEE Intell. Vehicles Symp. (IV), Oct. 2020, pp. 672–679.

The contributions of this article are summarized as follows:

1. We adopted the semantic chamfer matching (SCM) as the monocular map matching model and derived its analytical derivatives with respect to the 6-DoF camera pose. Also, an outlier association rejection strategy is proposed, thereby allowing both efficient and robust map-matching optimization.
2. tightly-coupled sliding window-based optimization algorithm to fuse visual feature and HD map land- mark features is proposed. Moreover, a linearization approximation algorithm is proposed to accelerate the calculation of SCM during the optimization to ensure the real-time performance of the whole system.
3. large scale dataset with HD map landmarks on KAIST Urban Dataset and Shougang Park is built for evaluating the map matching localization algorithms. Experiments are conducted on the proposed dataset, and the results have demonstrated the robustness and high precision of our self-localization algorithm.

## Method

### Problem Formulation

We start by considering the on-board camera pose as the equivalent vehicle pose for this study, as the camera is fixed to the vehicle. As such, the 6-DoF pose of camera frame $$C_t$$ at time t in global frame G is defined as G xCt = {G tCt , G RCt }, where G tCt ∈ R3 represents the translation vector from the origin of G to the origin of Ct , and G RCt ∈ SO(3) represents the 3 × 3 rotation matrix from frame G to frame Ct . The problem of vehicle localization can be defined as the camera pose G xCt estimation relative to the HD map, given the monocular image with HD map landmark observations up to time t.

